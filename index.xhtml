<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" 
               "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd" [
  <!ENTITY mathml "http://www.w3.org/1998/Math/MathML">
]>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8"/>
  <title>jQuery MathML Demo</title>
  <link type="text/css" href="pygments.css" rel="stylesheet"/>
  <script type='text/javascript' src='jquery-mathml.js'></script>
  
  <style type='text/css'>
    
    body {
        font-family: 'Georgia', serif;
    }

    math > * {
        font-family: STIXGeneral, CMEX10, sans-serif;
        font-size: 200%;
    }

    body div.qtip div.content{
       padding: 0;
       margin: 0;
       height: auto; min-height: auto;
       width: auto; min-width: auto;
    }

    #container {
       margin-left: 15%;
       margin-right: 15%;
       min-width: 850px;
       margin-top: 50px;
    }

    .selected {
        border: 2px solid red;
    }

  </style>

  
  <!-- This really only works well in Firefox 4 -->
  <script type='text/javascript'>
    // <![CDATA[

    $(document).ready(function() {
        selection_array = [];
        
        $('#selectable *').click(
            function(e){ 
                $(this).addClass('selected');
                e.stopPropagation();
                selection_array.push($(this));
            }
        );

    });

    function hightlight_ops() {
        $('mo','#schrodinger').css('background-color','#3DBBED');
    }

    function hightlight_psi() {
        $('*[title=Wavefunction]','#schrodinger').css('background-color','#FFDF00');
    }

    function replace_lhs() {
        $('#rhs').replaceWith("<msqrt>2</msqrt>");
    }

    function replace_rhs() {
        $('#lhs').replaceWith('<mfrac><mi>p</mi><mi>q</mi></mfrac>');
    }

    function replace_with_sqrt() {
        for(term in selection_array) {
            var rand = Math.floor(Math.random()*10);
            selection_array[term].replaceWith('<msqrt>' + rand +'</msqrt>'); 
        }
    }

    // ]]>
  </script>
  
</head>
<body>

<div id="container">

<h1>Browser Compatibility</h1>

<p>
If the Math on this page doesn't render properly you're probably using either Chrome, 
Safari, or Opera which sadly don't support MathML very well.
</p>

<p>
With the exception of the Mozilla developers, browser vendors simply haven't given 
mathematical content much concern even though it has been part of W3C specification 
for nearly a decade. If you are looking for cross browser rendering of mathmematics check out 
the <a href="http://www.mathjax.org"> MathJax</a> project.
</p>

<p>
The next generation browsers, namely Firefox 4 and nightly Webkit builds, now support
MathML in the HTML5 doctype eliminating the need to serve content in XHTML.
</p>

<h1>Selectors</h1>

This is the Schrödinger equation!

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML" id="schrodinger">
    <mi title='Imaginary Unit'>i</mi>
    <mi title="Reduced Plank's Constant">ħ</mi>
    <mfrac title="Partial Differential Operator">
        <mo>∂</mo>
        <mrow>
            <mo>∂</mo>

            <mi title="Time">t</mi>
        </mrow>
    </mfrac>
    <mn title="Wavefunction">Ψ</mn>
    <mo form="infix">=</mo>
    <mfrac>
        <mrow>

            <mo form="infix" lucida="true">-</mo>
            <msup>
                <mi title="Plank's constant">h</mi>
                <mn>2</mn>
            </msup>
        </mrow>
        <mrow>

            <mn>2</mn>
            <mi title="Mass of particle">m</mi>
        </mrow>
    </mfrac>
    <msup title="Laplacian">
        <mo>∇</mo>
        <mn>2</mn>

    </msup>
    <mn title="Wavefunction">Ψ</mn>
    <mo form="infix">+</mo>
    <mi title="Potential energy">V</mi>
    <mn title="Wavefunction">Ψ</mn>
</math>

<p>
<ul>
    <li><a href="javascript:hightlight_ops()">Highlight all operators</a></li>
    <li><a href="javascript:hightlight_psi()">Highlight wavefunction </a></li>

<div class="highlight"><pre><span class="kd">function</span> <span class="nx">hightlight_ops</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;mo&#39;</span><span class="p">,</span><span class="s1">&#39;#schrodinger&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;background-color&#39;</span><span class="p">,</span><span class="s1">&#39;#3DBBED&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">hightlight_psi</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;*[title=Wavefunction]&#39;</span><span class="p">,</span><span class="s1">&#39;#schrodinger&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;background-color&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</ul>

</p>

<h1>Manipulation</h1>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
    <mrow>
        <mi id="rhs">x</mi>
        <mo form="infix">=</mo>
        <mi id="lhs">y</mi>
    </mrow>
</math>

<p>
<ul>
    <li><a href="javascript:replace_lhs()">Replace LHS</a></li>
    <li><a href="javascript:replace_rhs()">Replace RHS</a></li>

<div class="highlight"><pre><span class="kd">function</span> <span class="nx">replace_lhs</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#rhs&#39;</span><span class="p">).</span><span class="nx">replaceWith</span><span class="p">(</span><span class="s2">&quot;&lt;msqrt&gt;2&lt;/msqrt&gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">replace_rhs</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#lhs&#39;</span><span class="p">).</span><span class="nx">replaceWith</span><span class="p">(</span><span class="s1">&#39;&lt;mfrac&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mfrac&gt;&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</ul>
</p>

<h1>Interactions</h1>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow id="selectable">
    <mrow>
      <msub>
        <mo>∫</mo>
        <mrow>
          <mi>M</mi>
        </mrow>
      </msub>
      <mrow>
        <mi>d</mi>
        <mo>ω</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <msub>
        <mo>&#x222B;</mo>
        <mrow>
          <mo>&#x2202;</mo>
          <mi>D</mi>
        </mrow>
      </msub>
      <mrow>
        <mo>ω</mo>
      </mrow>
    </mrow>
  </mrow>
</math>

<p>
<ul>
    <li>Click an element to select...</li>
    <li><a href="javascript:replace_with_sqrt()">Then click here to swap.</a></li>

<div class="highlight"><pre><span class="nx">selection_array</span> <span class="o">=</span> <span class="p">[];</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#selectable *&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span> 
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;selected&#39;</span><span class="p">);</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
        <span class="nx">selection_array</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">);</span>


<span class="kd">function</span> <span class="nx">replace_with_sqrt</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">term</span> <span class="k">in</span> <span class="nx">selection_array</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">rand</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="p">);</span>
        <span class="nx">selection_array</span><span class="p">[</span><span class="nx">term</span><span class="p">].</span><span class="nx">replaceWith</span><span class="p">(</span><span class="s1">&#39;&lt;msqrt&gt;&#39;</span> <span class="o">+</span> <span class="nx">rand</span> <span class="o">+</span><span class="s1">&#39;&lt;/msqrt&gt;&#39;</span><span class="p">);</span> 
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

</ul>
</p>

<a href="https://github.com/sdiehl/jquery-mathml">
<img alt="Fork me on GitHub" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" style="position: fixed; top: 0; right: 0; border: 0;"/>
</a>

</div>
</body>
</html>

